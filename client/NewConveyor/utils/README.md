# Система обработки ошибок соединения

Эта система автоматически обрабатывает ошибки соединения при выполнении API запросов и показывает пользователю понятные сообщения об ошибках.

## Как это работает

### 1. Утилита для API запросов (`api.ts`)

Содержит функции для выполнения HTTP запросов с автоматической обработкой ошибок:

- `get<T>(url, options)` - GET запрос
- `post<T>(url, data, options)` - POST запрос  
- `put<T>(url, data, options)` - PUT запрос
- `del<T>(url, options)` - DELETE запрос

Все функции автоматически:
- Обрабатывают ошибки сети
- Генерируют уникальные Request ID для отслеживания
- Определяют тип ошибки (соединение, сервер, и т.д.)

### 2. Компонент ошибки (`ConnectionError.tsx`)

Красивый модальный диалог, который показывается при ошибке соединения:
- Показывает понятное сообщение об ошибке
- Отображает Request ID для отладки
- Предлагает повторить запрос или продолжить работу

### 3. Контекст ошибок (`ErrorContext.tsx`)

Глобальный провайдер для управления ошибками во всем приложении:
- Автоматически показывает диалог при ошибке
- Позволяет повторить запрос одной кнопкой
- Можно использовать в любом компоненте через хук `useError()`

## Пример использования

```typescript
import { useError } from '../contexts/ErrorContext'
import { get, ApiException, isConnectionError } from '../utils/api'

function MyComponent() {
  const { showError } = useError()

  const loadData = async () => {
    try {
      const data = await get('/api/data')
      return data
    } catch (error) {
      if (error instanceof ApiException && isConnectionError(error)) {
        // Показываем диалог с ошибкой и возможностью повтора
        showError(error, () => {
          loadData() // Функция для повтора
        })
      } else {
        // Обрабатываем другие ошибки
        console.error('Ошибка:', error)
      }
    }
  }

  return <button onClick={loadData}>Загрузить данные</button>
}
```

## Что происходит при ошибке

1. **Ошибка соединения обнаружена** - система автоматически определяет проблему с сетью
2. **Генерируется Request ID** - уникальный идентификатор для отслеживания ошибки
3. **Показывается диалог** - пользователь видит понятное сообщение и может:
   - Повторить запрос (кнопка "Повторить")
   - Продолжить работу (кнопка "Продолжить")
   - Скопировать Request ID для отладки

## Преимущества

✅ Автоматическая обработка всех ошибок соединения  
✅ Понятные сообщения для пользователя  
✅ Возможность повтора запроса одной кнопкой  
✅ Request ID для отладки проблем  
✅ Легко использовать в любом компоненте  
✅ Модульная архитектура - каждый файл <200 строк

