# Production Readiness Review Report
**–î–∞—Ç–∞:** 2025-11-24
**–ü—Ä–æ–µ–∫—Ç:** StockMind
**Reviewer:** Claude

---

## üìã Executive Summary

**Overall Status:** ‚ö†Ô∏è **NOT PRODUCTION READY** - Critical issues found

**Critical Issues:** 4
**High Priority:** 6
**Medium Priority:** 8
**Low Priority:** 5

---

## 1. üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –î–µ–ø–ª–æ–π

### 1.1. –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ï–¥–∏–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ø–ª–æ—è | ‚ùå **CRITICAL** | –ù–µ—Ç Dockerfile, docker-compose, –¥–µ–ø–ª–æ–π-—Å–∫—Ä–∏–ø—Ç–æ–≤ |
| –ü–æ–≤—Ç–æ—Ä—è–µ–º—ã–π –¥–µ–ø–ª–æ–π | ‚ùå **CRITICAL** | –ù–µ–ª—å–∑—è —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤ –æ–¥–∏–Ω —à–∞–≥ |
| –û—Ç–∫–∞—Ç –≤–µ—Ä—Å–∏–∏ | ‚ùå **CRITICAL** | –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—Ç–∫–∞—Ç–∞ |
| CI/CD | ‚ùå **HIGH** | –ù–µ—Ç GitHub Actions workflows |

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Ç `Dockerfile` –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç `docker-compose.yml` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ù–µ—Ç `.github/workflows/` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç deployment —Å–∫—Ä–∏–ø—Ç–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –°–æ–∑–¥–∞—Ç—å Dockerfile (multi-stage build)
2. –°–æ–∑–¥–∞—Ç—å docker-compose.yml (app + postgres + redis)
3. –°–æ–∑–¥–∞—Ç—å GitHub Actions –¥–ª—è CI/CD
4. –î–æ–±–∞–≤–∏—Ç—å health checks –≤ Docker

---

### 1.2. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ –¥–∞–Ω–Ω—ã–µ

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ú–∏–≥—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ push | ‚ùå **CRITICAL** | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `drizzle-kit push` (–æ–ø–∞—Å–Ω–æ –≤ –ø—Ä–æ–¥–µ) |
| –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π | ‚ùå **HIGH** | –ù–µ—Ç –∫–æ–º–∞–Ω–¥—ã rollback |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î | ‚ö†Ô∏è **MEDIUM** | –ù–µ—Ç staging –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü | ‚ö†Ô∏è **MEDIUM** | –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å |

**–ü—Ä–æ–±–ª–µ–º—ã:**
```json
// package.json
"db:push": "drizzle-kit push"  // ‚ö†Ô∏è –û–ø–∞—Å–Ω–æ! –ú–æ–∂–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
```

**–ù–∞–π–¥–µ–Ω–æ:**
- ‚ùå –ù–µ—Ç –ø–∞–ø–∫–∏ `drizzle/migrations/`
- ‚ùå –ù–µ—Ç `db:migrate`, `db:rollback` —Å–∫—Ä–∏–ø—Ç–æ–≤
- ‚ùå `drizzle-kit push` –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `drizzle-kit generate` + `drizzle-kit migrate`
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ö–µ–º—ã
3. –î–æ–±–∞–≤–∏—Ç—å rollback —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –∫–æ–ø–∏–∏ –±–æ–µ–≤–æ–π –ë–î

---

## 2. üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 2.1. –°–µ—Å—Å–∏–∏ –∏ Cookies

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| JWT –≤–º–µ—Å—Ç–æ —Å–µ—Å—Å–∏–π | ‚úÖ **OK** | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JWT auth |
| httpOnly cookies | N/A | JWT –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö |
| secure –≤ –ø—Ä–æ–¥–µ | ‚úÖ **OK** | CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω |
| CSRF –∑–∞—â–∏—Ç–∞ | ‚úÖ **OK** | JWT –Ω–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω CSRF |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/middleware/jwt-auth.ts
export const requireAuth: RequestHandler = async (req, res, next) => {
  const authHeader = req.headers.authorization;
  const token = extractToken(authHeader);
  // ‚úÖ JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è
}
```

‚úÖ **–û—Ç–ª–∏—á–Ω–æ:** JWT auth —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, CSRF –Ω–µ –Ω—É–∂–µ–Ω.

---

### 2.2. Rate Limiting

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| /login, /register | ‚úÖ **OK** | 5 –ø–æ–ø—ã—Ç–æ–∫ / 15 –º–∏–Ω |
| AI endpoints | ‚úÖ **OK** | 10 –∑–∞–ø—Ä–æ—Å–æ–≤ / —á–∞—Å |
| API endpoints | ‚úÖ **OK** | 100 –∑–∞–ø—Ä–æ—Å–æ–≤ / 15 –º–∏–Ω |
| Upload endpoints | ‚úÖ **OK** | 20 uploads / —á–∞—Å |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/middleware/rate-limiter.ts
export const authLimiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 5,  // ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç—Ä–æ–≥–æ
  skipSuccessfulRequests: true
});

export const aiLimiter = rateLimit({
  windowMs: 60 * 60 * 1000,
  max: 10  // ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç—Ä–∞—Ç BYOK –∫–ª—é—á–∞
});
```

‚úÖ **–û—Ç–ª–∏—á–Ω–æ:** Rate limiting –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ.

---

### 2.3. BYOK-–∫–ª—é—á–∏ (Bring Your Own Key)

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ö–ª—é—á–∏ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è | ‚ö†Ô∏è **MEDIUM** | –ï—Å—Ç—å console.error —Å –æ—à–∏–±–∫–∞–º–∏ API |
| –ö–ª—é—á–∏ –Ω–µ —É—Ö–æ–¥—è—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç | ‚úÖ **OK** | –¢–æ–ª—å–∫–æ safe fields |
| –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –±—ç–∫–µ | ‚úÖ **OK** | Encryption –≤ storage layer |
| –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ—à–∏–±–∫–∏ | ‚ö†Ô∏è **MEDIUM** | –ú–æ–≥—É—Ç —Å–≤–µ—Ç–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/routes/api-keys.routes.ts
const safeKeys = keys.map(key => ({
  id: key.id,
  provider: key.provider,
  last4: key.last4,  // ‚úÖ –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 —Å–∏–º–≤–æ–ª–∞
  // –ù–ï–¢ encryptedKey - –ø—Ä–∞–≤–∏–ª—å–Ω–æ!
}));
```

‚úÖ **–•–æ—Ä–æ—à–æ:** API keys –∑–∞—â–∏—â–µ–Ω—ã.

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// server/routes/api-keys.routes.ts:108
console.error("Error testing API key:", error);
// ‚ö†Ô∏è –ú–æ–∂–µ—Ç –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ console.error –Ω–∞ Winston logger
2. Sanitize –æ—à–∏–±–∫–∏ –æ—Ç AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –ø–µ—Ä–µ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. –ù–µ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–µ error.message –æ—Ç OpenAI/Anthropic

---

### 2.4. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ù–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ | ‚úÖ **OK** | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è .env |
| DEBUG –æ—Ç–∫–ª—é—á–µ–Ω –≤ –ø—Ä–æ–¥–µ | ‚ö†Ô∏è **MEDIUM** | console.* –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è |
| CORS –Ω–µ * –≤ –ø—Ä–æ–¥–µ | ‚ö†Ô∏è **HIGH** | Fallback –Ω–∞ allow all |

**–ü—Ä–æ–±–ª–µ–º—ã:**
```typescript
// server/middleware/security.ts:33-36
if (allowedOrigins.length === 0 && process.env.NODE_ENV === 'production') {
  console.warn('[Security] No ALLOWED_ORIGINS configured, allowing all origins');
  return callback(null, true);  // ‚ö†Ô∏è –û–ü–ê–°–ù–û!
}
```

‚ùå **CRITICAL:** –ï—Å–ª–∏ `ALLOWED_ORIGINS` –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–æ–¥–µ - —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –í–°–ï origins!

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –°–¥–µ–ª–∞—Ç—å `ALLOWED_ORIGINS` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –≤ production
2. –£–±—Ä–∞—Ç—å fallback –Ω–∞ allow all
3. –ó–∞–º–µ–Ω–∏—Ç—å console.warn –Ω–∞ logger.error –∏ –≤—ã–∫–∏–Ω—É—Ç—å exception

---

## 3. üîå API –∏ –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã

### 3.1. –ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–∞–Ω–Ω—ã—Ö

| Endpoint | –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–æ–±–ª–µ–º—ã |
|----------|--------------|----------|
| `/api/auth/me` | ‚úÖ OK | –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç |
| `/api/settings/api-keys` | ‚úÖ OK | Zod validation |
| `/api/instagram/items` | ‚úÖ OK | –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç |
| `/api/projects/*` | ‚ö†Ô∏è MEDIUM | –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å null handling |

**–ù–∞–π–¥–µ–Ω–æ:**
- ‚úÖ Zod schemas –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
- ‚ö†Ô∏è console.error –≤–º–µ—Å—Ç–æ Winston –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –æ—à–∏–±–æ–∫

---

### 3.2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| 401/403 handling | ‚úÖ **OK** | –§—Ä–æ–Ω—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ /login |
| 500 graceful handling | ‚úÖ **OK** | –ï—Å—Ç—å error boundary |
| 400/422 validation errors | ‚úÖ **OK** | Zod —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/index.ts:58-68
app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {
  const status = err.status || err.statusCode || 500;
  const message = err.message || "Internal Server Error";

  logger.error('Error handler caught exception', {
    error: message,
    status,
    stack: err.stack
  });

  res.status(status).json({ message });  // ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
});
```

‚úÖ **–•–æ—Ä–æ—à–æ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π error handler.

---

## 4. ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 4.1. –¢—è–∂—ë–ª—ã–µ –º–µ—Å—Ç–∞

| –§–∞–π–ª/Endpoint | –ü—Ä–æ–±–ª–µ–º—ã | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|---------------|----------|-----------|
| `apify-service.ts` | ~15 console.log | MEDIUM |
| `instagram-download.ts` | ~10 console.log | MEDIUM |
| Instagram items routes | Potential N+1 | HIGH |

**–ü—Ä–æ–±–ª–µ–º—ã N+1 (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏):**
```typescript
// –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ N+1 –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å–≤—è–∑–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ item
const items = await storage.getInstagramItems(sourceId);
// –ö–∞–∂–¥—ã–π item –º–æ–∂–µ—Ç —Ç—è–Ω—É—Ç—å userId, sourceId –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ SELECT
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. Audit SQL queries with Drizzle
2. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞:
   - `instagram_items.sourceId`
   - `instagram_items.userId`
   - `instagram_items.createdAt`
   - `instagram_sources.userId`
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.with()` / joins –¥–ª—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–µ–π

---

### 4.2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤ | ‚ö†Ô∏è **HIGH** | –ù–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∏ |
| –õ–∏–º–∏—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ | ‚ùå **MEDIUM** | –ù–µ—Ç –ª–∏–º–∏—Ç–∞ |
| –õ–∏–º–∏—Ç AI –∑–∞–ø—Ä–æ—Å–æ–≤ | ‚úÖ **OK** | 10/—á–∞—Å rate limiter |

**–ü—Ä–æ–±–ª–µ–º—ã:**
```typescript
// –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ - –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 10k+ –∑–∞–ø–∏—Å–µ–π
const items = await storage.getInstagramItems(sourceId);
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é:
   ```typescript
   interface PaginationParams {
     page: number;
     limit: number; // default 50, max 100
   }
   ```
2. –î–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç—ã:
   - 100 –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - 1000 Instagram items –Ω–∞ source
   - 100 API keys –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## 5. üõ°Ô∏è –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

### 5.1. Graceful Shutdown

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| Graceful shutdown | ‚úÖ **OK** | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ lib/graceful-shutdown.ts |
| –ó–∞–∫—Ä—ã—Ç–∏–µ DB connections | ‚úÖ **OK** | Drizzle pooling |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/lib/graceful-shutdown.ts
export function setupGracefulShutdown(server: Server) {
  const shutdown = async (signal: string) => {
    logger.info(`${signal} received, starting graceful shutdown...`);

    server.close(() => {
      logger.info('HTTP server closed');
      process.exit(0);
    });

    setTimeout(() => {
      logger.error('Forced shutdown after 30s timeout');
      process.exit(1);
    }, 30000);
  };

  process.on('SIGTERM', () => shutdown('SIGTERM'));
  process.on('SIGINT', () => shutdown('SIGINT'));
}
```

‚úÖ **–û—Ç–ª–∏—á–Ω–æ:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è graceful shutdown.

---

### 5.2. –ë—ç–∫–∞–ø—ã

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ü–ª–∞–Ω –±—ç–∫–∞–ø–∞ –ë–î | ‚ùå **CRITICAL** | –ù–µ—Ç —Å–∫—Ä–∏–ø—Ç–æ–≤/–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ |
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã | ‚ùå **HIGH** | –ù–µ—Ç cron jobs |
| –ü—Ä–æ—Ü–µ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è | ‚ùå **HIGH** | –ù–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã:
   ```bash
   # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø –≤ 3:00 AM
   0 3 * * * pg_dump stockmind > /backups/stockmind_$(date +\%Y\%m\%d).sql
   ```
2. –•—Ä–∞–Ω–∏—Ç—å –±—ç–∫–∞–ø—ã –º–∏–Ω–∏–º—É–º 30 –¥–Ω–µ–π
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑ –≤ –º–µ—Å—è—Ü
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤ `BACKUP.md`

---

## 6. üé® UX / –ü—Ä–æ–¥—É–∫—Ç

### 6.1. –ü—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è

| –°—Ü–µ–Ω–∞—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|----------|--------|----------|
| –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ | ‚úÖ | –ï—Å—Ç—å empty state |
| –ù–µ—Ç Instagram sources | ‚úÖ | –ï—Å—Ç—å placeholder |
| –ù–µ—Ç API –∫–ª—é—á–µ–π | ‚ö†Ô∏è | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω—É–∂–Ω–æ |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ empty states –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ
2. –î–æ–±–∞–≤–∏—Ç—å onboarding flow –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ "–ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ?"

---

## 7. üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –î–∞–Ω–Ω—ã—Ö

### 7.1. Access Control

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| User isolation | ‚úÖ **OK** | requireAuth + getUserId |
| Projects access check | ‚úÖ **OK** | userId verification |
| Instagram items check | ‚úÖ **OK** | sourceId ‚Üí userId check |

**–ù–∞–π–¥–µ–Ω–æ:**
```typescript
// server/routes/api-keys.routes.ts
const userId = getUserId(req);
const keys = await storage.getApiKeys(userId);  // ‚úÖ –§–∏–ª—å—Ç—Ä –ø–æ userId
```

‚úÖ **–•–æ—Ä–æ—à–æ:** Access control —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

### 7.2. –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –¢–æ–∫–µ–Ω—ã –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è | ‚úÖ **OK** | JWT –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è |
| API –∫–ª—é—á–∏ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è | ‚ö†Ô∏è **MEDIUM** | –ú–æ–≥—É—Ç –±—ã—Ç—å –≤ error.message |
| –ü–∞—Ä–æ–ª–∏ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è | ‚úÖ **OK** | –•–µ—à–∏—Ä—É—é—Ç—Å—è bcrypt |

**–ü—Ä–æ–±–ª–µ–º—ã:**
- 48 —Ñ–∞–π–ª–æ–≤ –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `console.*` (545 –≤—ã–∑–æ–≤–æ–≤)
- –ò–∑ –Ω–∏—Ö ~250 —É–∂–µ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Winston
- –û—Å—Ç–∞–µ—Ç—Å—è ~295 console.* –≤—ã–∑–æ–≤–æ–≤

---

## 8. üåç –û–∫—Ä—É–∂–µ–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| dev / staging / prod | ‚ùå **HIGH** | –ù–µ—Ç staging –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| –†–∞–∑–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | ‚ö†Ô∏è **MEDIUM** | –¢–æ–ª—å–∫–æ dev –∏ prod |
| –†–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ | ‚úÖ **OK** | .env —Ñ–∞–π–ª—ã |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –°–æ–∑–¥–∞—Ç—å staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–ª–∏–∑–∫–æ –∫ prod)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ DATABASE_URL –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è:
   - PR ‚Üí staging
   - merge to main ‚Üí prod (manual approval)

---

## 9. üìö –†–µ–≥–ª–∞–º–µ–Ω—Ç—ã

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –î–µ—Ç–∞–ª–∏ |
|----------|--------|--------|
| –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –ø—Ä–∏ —Å–±–æ—è—Ö | ‚ùå **MEDIUM** | –ù–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã |
| –î–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–¥ –ë–î | ‚ö†Ô∏è **MEDIUM** | –ù–µ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω |
| –ü—Ä–æ—Ü–µ—Å—Å rollback | ‚ùå **HIGH** | –ù–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –°–æ–∑–¥–∞—Ç—å `RUNBOOK.md` —Å –ø—Ä–æ—Ü–µ–¥—É—Ä–∞–º–∏:
   - –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä —É–ø–∞–ª
   - –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
   - –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç
2. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø—ã –≤ `ACCESS.md`
3. –°–æ–∑–¥–∞—Ç—å on-call —Ä–æ—Ç–∞—Ü–∏—é (–µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ >1)

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–π –°–∫–æ—Ä

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –¥–µ–ø–ª–æ–π | 2/10 | ‚ùå –ö—Ä–∏—Ç–∏—á–Ω–æ |
| 2. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 7/10 | ‚ö†Ô∏è –•–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å issues |
| 3. API –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã | 8/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 5/10 | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ä–∞–±–æ—Ç—ã |
| 5. –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å | 6/10 | ‚ö†Ô∏è –ù–µ—Ç –±—ç–∫–∞–ø–æ–≤ |
| 6. UX | 7/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö | 8/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| 8. –û–∫—Ä—É–∂–µ–Ω–∏—è | 4/10 | ‚ö†Ô∏è –ù–µ—Ç staging |
| 9. –†–µ–≥–ª–∞–º–µ–Ω—Ç—ã | 2/10 | ‚ùå –ù–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã |

**–û–±—â–∏–π —Å–∫–æ—Ä: 5.4/10** - ‚ö†Ô∏è **–ù–ï –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

---

## ‚úÖ Action Items (–ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–æ)

### üî¥ CRITICAL (Must fix before prod)

1. **–ú–∏–≥—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–æ drizzle push**
   - [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
   - [ ] –î–æ–±–∞–≤–∏—Ç—å `db:migrate` –∏ `db:rollback`
   - [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging

2. **Docker –∏ deployment**
   - [ ] –°–æ–∑–¥–∞—Ç—å Dockerfile
   - [ ] –°–æ–∑–¥–∞—Ç—å docker-compose.yml
   - [ ] –î–æ–±–∞–≤–∏—Ç—å health checks

3. **–ë—ç–∫–∞–ø—ã –ë–î**
   - [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
   - [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
   - [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

4. **CORS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ**
   - [ ] –°–¥–µ–ª–∞—Ç—å ALLOWED_ORIGINS –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
   - [ ] –£–±—Ä–∞—Ç—å fallback –Ω–∞ allow all
   - [ ] –î–æ–±–∞–≤–∏—Ç—å validation –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

---

### üü† HIGH (Should fix before prod)

5. **Console.* –º–∏–≥—Ä–∞—Ü–∏—è**
   - [x] 250+ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ Winston
   - [ ] ~295 –≤—ã–∑–æ–≤–æ–≤ –æ—Å—Ç–∞–ª–æ—Å—å
   - [ ] –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ: api-keys.routes.ts, apify-service.ts

6. **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**
   - [ ] Instagram items
   - [ ] Projects list
   - [ ] API keys list
   - [ ] Default: 50, max: 100

7. **CI/CD**
   - [ ] GitHub Actions –¥–ª—è —Ç–µ—Å—Ç–æ–≤
   - [ ] –ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –Ω–∞ staging
   - [ ] Manual approval –¥–ª—è prod

8. **Staging –æ–∫—Ä—É–∂–µ–Ω–∏–µ**
   - [ ] –û—Ç–¥–µ–ª—å–Ω–∞—è –ë–î
   - [ ] –û—Ç–¥–µ–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
   - [ ] –ö–æ–ø–∏—è prod –∫–æ–Ω—Ñ–∏–≥–∞

---

### üü° MEDIUM (Good to have)

9. **–ò–Ω–¥–µ–∫—Å—ã –ë–î**
10. **–õ–∏–º–∏—Ç—ã –Ω–∞ —Ä–µ—Å—É—Ä—Å—ã**
11. **Runbook –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**
12. **Empty states –ø—Ä–æ–≤–µ—Ä–∫–∞**

---

## üìÅ –§–∞–π–ª—ã –¥–ª—è –°–æ–∑–¥–∞–Ω–∏—è

1. `Dockerfile` - Multi-stage build
2. `docker-compose.yml` - Dev environment
3. `.github/workflows/ci.yml` - CI/CD
4. `drizzle/migrations/*.sql` - DB migrations
5. `RUNBOOK.md` - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
6. `BACKUP.md` - –ü—Ä–æ—Ü–µ–¥—É—Ä—ã –±—ç–∫–∞–ø–∞
7. `ACCESS.md` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞–º–∏

---

**Estimated time to production ready:** 2-3 –Ω–µ–¥–µ–ª–∏ (–ø—Ä–∏ 1 —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–µ)

**Next steps:**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å CRITICAL issues (1 –Ω–µ–¥–µ–ª—è)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å HIGH issues (1 –Ω–µ–¥–µ–ª—è)
3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ staging (3-5 –¥–Ω–µ–π)
4. Production deployment
