# ‚ùì –í–æ–ø—Ä–æ—Å—ã –ø–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è–º –∫ –ø–ª–∞–Ω—É

## ‚úÖ –ß—Ç–æ –ø–æ–Ω—è—Ç–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ:

1. **–£–±—Ä–∞–ª–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —É–ø—Ä–æ—â–µ–Ω–∏–µ, —Ö–æ—Ä–æ—à–æ ‚úÖ
2. **Revision Flow** - –ª–æ–≥–∏—á–Ω–æ, –ø–æ–Ω—è—Ç–Ω–æ ‚úÖ
3. **–°—Ç–æ–∏–º–æ—Å—Ç—å AI** - –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ
4. **Manual Trigger** - –ø–æ–ª–µ–∑–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚úÖ
5. **Error Handling** - —Ö–æ—Ä–æ—à–æ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è:

### 1. **QC Agent - 4 parallel –≤—ã–∑–æ–≤–∞ vs 1 –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π**

**–í –ø–ª–∞–Ω–µ —É–∫–∞–∑–∞–Ω–æ:** QC = 4 parallel AI calls (Haiku) = $0.004

**–í –º–æ—ë–º review —è –ø—Ä–µ–¥–ª–∞–≥–∞–ª:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `analyzeScriptAdvanced()` = 1 call = $0.01-0.02

**–í–æ–ø—Ä–æ—Å:**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º 4 parallel –≤—ã–∑–æ–≤–∞ (–∫–∞–∫ –≤ –ø–ª–∞–Ω–µ)?
- –ò–ª–∏ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –≤ –æ–¥–∏–Ω —á–µ—Ä–µ–∑ `analyzeScriptAdvanced()` (–∫–∞–∫ —è –ø—Ä–µ–¥–ª–∞–≥–∞–ª)?

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `analyzeScriptAdvanced()` - –ø—Ä–æ—â–µ, –±—ã—Å—Ç—Ä–µ–µ, —É–∂–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ.

---

### 2. **Revision Flow - —Å–≤—è–∑—å —Å auto_script**

**–í –ø–ª–∞–Ω–µ:** "–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å —Ç–µ–º –∂–µ auto_script.id"

**–í–æ–ø—Ä–æ—Å:**
- –ü—Ä–∏ revision —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π `conveyor_item`, –Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `auto_script`?
- –ò–ª–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π `auto_script` —Å `parent_script_id`?
- –ö–∞–∫ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é revisions –≤ UI?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```typescript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –û–±–Ω–æ–≤–ª—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
auto_scripts.revision_count++
auto_scripts.status = 'pending'
auto_scripts.scenes = new_scenes

// –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π —Å —Å—Å—ã–ª–∫–æ–π
auto_scripts.parent_script_id = old_script.id
auto_scripts.revision_number = old_script.revision_count + 1
```

---

### 3. **Error Handling - checkpointing**

**–í –ø–ª–∞–Ω–µ:** Retry —á–µ—Ä–µ–∑ API –¥–ª—è failed items

**–í–æ–ø—Ä–æ—Å:**
- –ü—Ä–∏ retry –Ω–∞—á–∏–Ω–∞–µ–º —Å –Ω–∞—á–∞–ª–∞ (Stage 1) –∏–ª–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ stage?
- –ù—É–∂–µ–Ω –ª–∏ checkpointing –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤?

**–ü—Ä–∏–º–µ—Ä:**
```
Item —É–ø–∞–ª –Ω–∞ Stage 5 (Writer)
‚Üí –ü—Ä–∏ retry –Ω–∞—á–∏–Ω–∞–µ–º —Å Stage 5 (–∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ Stage 1-4)
‚Üí –ò–ª–∏ –Ω–∞—á–∏–Ω–∞–µ–º —Å Stage 1 (—Ç–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)?
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–∏–Ω–∞—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ stage (checkpointing).

---

### 4. **Manual Trigger - rate limiting**

**–í –ø–ª–∞–æ–Ω:** POST /api/conveyor/trigger - –∑–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–µ–π—á–∞—Å

**–í–æ–ø—Ä–æ—Å:**
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ `daily_limit` –∫ manual trigger?
- –ò–ª–∏ manual trigger –æ–±—Ö–æ–¥–∏—Ç –ª–∏–º–∏—Ç—ã?
- –ù—É–∂–µ–Ω –ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –¥–ª—è manual triggers?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```typescript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –°—á–∏—Ç–∞—Ç—å –≤ daily_limit
if (todayCount >= settings.dailyLimit) {
  return error('Daily limit reached');
}

// –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–¥–µ–ª—å–Ω—ã–π –ª–∏–º–∏—Ç
if (manualTriggerCount >= settings.manualLimit) {
  return error('Manual trigger limit reached');
}
```

---

### 5. **Revision Flow - –ª–∏–º–∏—Ç 3 revision**

**–í –ø–ª–∞–Ω–µ:** "–º–∞–∫—Å–∏–º—É–º 3 revision –Ω–∞ –æ–¥–∏–Ω —Å—Ü–µ–Ω–∞—Ä–∏–π"

**–í–æ–ø—Ä–æ—Å:**
- –õ–∏–º–∏—Ç 3 –Ω–∞ –æ–¥–∏–Ω `auto_script` –∏–ª–∏ –Ω–∞ –≤—Å—é —Ü–µ–ø–æ—á–∫—É (parent + revisions)?
- –ß—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª–æ–Ω–∏–ª –ø–æ—Å–ª–µ 3 revisions ‚Üí –º–æ–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–∑ —Ç–æ–π –∂–µ —Å—Ç–∞—Ç—å–∏?

**–ü—Ä–∏–º–µ—Ä:**
```
Script 1 ‚Üí Revise ‚Üí Script 2 ‚Üí Revise ‚Üí Script 3 ‚Üí Revise ‚Üí Script 4
‚Üí –ü–æ—Å–ª–µ 3 revisions –ª–∏–º–∏—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª–æ–Ω—è–µ—Ç Script 4
‚Üí –ú–æ–∂–µ—Ç –ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Script 5 –∏–∑ —Ç–æ–π –∂–µ —Å—Ç–∞—Ç—å–∏? (–Ω–æ–≤—ã–π conveyor_item)
```

---

### 6. **Error Handling - retry failed items**

**–í –ø–ª–∞–æ–Ω:** POST /api/conveyor/items/:id/retry

**–í–æ–ø—Ä–æ—Å:**
- –ü—Ä–∏ retry –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (threshold, patterns) –∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ?
- –ù—É–∂–µ–Ω –ª–∏ –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ retries?

**–ü—Ä–∏–º–µ—Ä:**
```
Item failed –Ω–∞ Stage 3 (Analyst)
‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω–∏–ª settings (–ø–æ–Ω–∏–∑–∏–ª threshold)
‚Üí Retry –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—ã–µ –∏–ª–∏ –Ω–æ–≤—ã–µ settings?
```

---

### 7. **–°—Ç–æ–∏–º–æ—Å—Ç—å AI - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**

**–í –ø–ª–∞–Ω–µ:** ~$0.06 –Ω–∞ item, ~$18/–º–µ—Å—è—Ü –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–í–æ–ø—Ä–æ—Å:**
- –ù—É–∂–µ–Ω –ª–∏ budget limit –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?
- –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞?
- –ù—É–∂–Ω–∞ –ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:**
```typescript
interface ConveyorSettings {
  // ...
  monthlyBudgetLimit?: number; // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  currentMonthCost: number;
}

// –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏:
if (currentMonthCost >= monthlyBudgetLimit) {
  // –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ –º–µ—Å—è—Ü–∞
  // –ò–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –±–æ–ª–µ–µ –¥–µ—à—ë–≤—ã–µ –º–æ–¥–µ–ª–∏?
}
```

---

### 8. **Revision Flow - Writer –ø—Ä–æ–º–ø—Ç**

**–í –ø–ª–∞–Ω–µ:** "Writer –ø–æ–ª—É—á–∞–µ—Ç revision_notes + previous_script"

**–í–æ–ø—Ä–æ—Å:**
- Writer –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ—Ç –≤–µ—Å—å —Å—Ü–µ–Ω–∞—Ä–∏–π –∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —á–∞—Å—Ç–∏?
- –ù—É–∂–Ω–æ –ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É (scenes) –∏–ª–∏ –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å?

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–º–ø—Ç–∞:**
```
–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞
"–ü–µ—Ä–µ–ø–∏—à–∏ —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å —É—á—ë—Ç–æ–º: {notes}"

–í–∞—Ä–∏–∞–Ω—Ç 2: –ß–∞—Å—Ç–∏—á–Ω–∞—è –ø—Ä–∞–≤–∫–∞
"–ò—Å–ø—Ä–∞–≤—å —Ç–æ–ª—å–∫–æ Scene 3 –∏ Scene 5 –ø–æ –∑–∞–º–µ—á–∞–Ω–∏—è–º: {notes}"
```

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

### –ö—Ä–∏—Ç–∏—á–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å:

1. ‚úÖ **QC Agent** - 4 calls vs 1 call (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é 1 —á–µ—Ä–µ–∑ `analyzeScriptAdvanced()`)
2. ‚úÖ **Revision —Å–≤—è–∑—å** - –∫–∞–∫ —Å–≤—è–∑—ã–≤–∞—Ç—å revisions —Å auto_script
3. ‚úÖ **Checkpointing** - –Ω—É–∂–µ–Ω –ª–∏ –¥–ª—è retry

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å:

4. ‚ö†Ô∏è **Manual trigger limits** - –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ daily limits
5. ‚ö†Ô∏è **Revision –ª–∏–º–∏—Ç** - –Ω–∞ —á—Ç–æ –∏–º–µ–Ω–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è
6. ‚ö†Ô∏è **Budget limits** - –Ω—É–∂–Ω—ã –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å—Ç–æ–∏–º–æ—Å—Ç–∏
–¥–∞ –Ω—É–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –±—é–¥–∂–µ—Ç—É. –µ—Å–ª–∏ –ø–æ –±—é–¥–∂–µ—Ç—É –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ —Ç–æ –Ω–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–µ –¥–µ–ª–∞–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ 7/10 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –ª–∏–º–∏—Ç—ã –±—é–¥–∂–µ—Ç–∞ –≤–∞–∂–Ω–µ–µ
---

## ‚úÖ –ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å –ø–æ—Å–ª–µ —É—Ç–æ—á–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤!

